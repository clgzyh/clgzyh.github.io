---
layout    : post
title     : "Ubuntu系统安装教程"
date      : 2025-12-02
lastupdate: 2025-12-02
categories: Linux
cheatsheet: true
---

# Ubuntu系统安装教程

>  本文以使用Vmware安装Ubuntu22.04为例



## 安装过程

进入安装页面，直接选择第一个选项，**进入安装**流程

![image-20251202133516742](../assets/img/Install-Ubuntu-system.assets/image-20251202133516742.png)

选择**系统语言**，建议选用 `English`

![image-20251202133341450](../assets/img/Install-Ubuntu-system.assets/image-20251202133341450.png)

这里是让我们更新，选择**跳过更新**并继续

![image-20251202133618504](../assets/img/Install-Ubuntu-system.assets/image-20251202133618504.png)

选择**键盘语言**，无需改动

![image-20251202133714520](../assets/img/Install-Ubuntu-system.assets/image-20251202133714520.png)

选择**安装类型**，默认是Ubuntu Server，建议改成最小化安装（第二个选项），减少系统安装时间。

![image-20251202134005946](../assets/img/Install-Ubuntu-system.assets/image-20251202134005946.png)

**网卡配置**，可以直接**选择DHCP**，这样的话，不会因为配置错误引发问题，后续可以进入系统后改成静态IP

![image-20251202134142806](../assets/img/Install-Ubuntu-system.assets/image-20251202134142806.png)

**改成静态IP**的方法如下

选中网卡信息，回车选中，在弹出来的选项卡中，选中Edit IPv4，回车。

![image-20251202134333015](../assets/img/Install-Ubuntu-system.assets/image-20251202134333015.png)

会弹出一个选项卡，默认是DHCP，我们更换成Manual，回车

![image-20251202134451225](../assets/img/Install-Ubuntu-system.assets/image-20251202134451225.png)

由于我这张ens33是一张内网网卡，仅配置地址，不配置网关

![image-20251202135255871](../assets/img/Install-Ubuntu-system.assets/image-20251202135255871.png)

外网网卡配置对应的网关

![image-20251202135432512](../assets/img/Install-Ubuntu-system.assets/image-20251202135432512.png)

Done进入下一步，选择代理服务器地址，选择跳过

![image-20251202135654752](../assets/img/Install-Ubuntu-system.assets/image-20251202135654752.png)

**配置镜像源**

默认是ubuntu的官方源，国内环境，会比较慢

![image-20251202135746853](../assets/img/Install-Ubuntu-system.assets/image-20251202135746853.png)

改成国内的镜像源，如清华大学的ubuntu镜像源。`https://mirrors.tuna.tsinghua.edu.cn/ubuntu/`，这里有个小技巧，在使用Vmware的时候，按住`Ctrl+Alt`，退出虚拟机操作层面，就可以直接`Ctrl+v`进行粘贴了。

![image-20251202140111874](../assets/img/Install-Ubuntu-system.assets/image-20251202140111874.png)

如果在下面的小白框中，无法正确获取源的信息，建议将网卡改回DHCP模式，自动获取IP

**配置硬盘**

可以选择`Custom storage layout`，自定义硬盘分区，也可以选择默认的`Use an entire disk`直接使用。

![image-20251202140547581](../assets/img/Install-Ubuntu-system.assets/image-20251202140547581.png)

进入自定义硬盘分区后，可以看到可用设备中，有`/dev/sda`和`free space`的标识，`free space`代表未分配空间，可自行划分

![image-20251202140838041](../assets/img/Install-Ubuntu-system.assets/image-20251202140838041.png)

选中`free space`回车，选择`Add GPT Partition`，在空闲空间上创建GPT分区

![image-20251202140915925](../assets/img/Install-Ubuntu-system.assets/image-20251202140915925.png)

选择分区大小（Size）、文件系统类型（Format）、挂载点（Mount），根据需求自我定义。

![image-20251202141102959](../assets/img/Install-Ubuntu-system.assets/image-20251202141102959.png)

使用LVM创建适用于k8s集群的磁盘分区

![image-20251202143155235](../assets/img/Install-Ubuntu-system.assets/image-20251202143155235.png)

弹出来的确认窗口，选择`Continue`

![image-20251202143750840](../assets/img/Install-Ubuntu-system.assets/image-20251202143750840.png)

服务器信息配置

![image-20251202144143221](../assets/img/Install-Ubuntu-system.assets/image-20251202144143221.png)

跳过升级

![image-20251202144211352](../assets/img/Install-Ubuntu-system.assets/image-20251202144211352.png)

安装OpenSSH server

![image-20251202144241566](../assets/img/Install-Ubuntu-system.assets/image-20251202144241566.png)

这里直接不选择，继续下一步

![image-20251202144252937](../assets/img/Install-Ubuntu-system.assets/image-20251202144252937.png)

进入最后一步，等待安装

![image-20251202144332431](../assets/img/Install-Ubuntu-system.assets/image-20251202144332431.png)

安装完成，Reboot Now

![image-20251202144547420](../assets/img/Install-Ubuntu-system.assets/image-20251202144547420.png)

后续会有提示卸载光驱，直接`ENTER`就行



## 安装完成后

使用前面设置的服务器主机名 与 密码登入系统

![image-20251202154119113](../assets/img/Install-Ubuntu-system.assets/image-20251202154119113.png)

更新软件包索引

```bash
sudo apt update -y 
```

更新软件包

```bash
sudo apt upgrade -y 
```

最小化安装的ubuntu，是没有vim、ping等命令的，使用`apt`或`apt-get`进行安装

```bash
sudo apt-get install -y vim iputils-ping
```

编辑sshd服务配置文件，开放ssh服务

```bash
sudo vim /etc/ssh/sshd_config
```

让ssh允许通过root登陆，使用密码登陆的方式连接

```diff
- 33 #PermitRootLogin prohibit-password
+ 33 PermitRootLogin yes
- 57 #PasswordAuthentication yes
+ 57 PasswordAuthentication yes
```

重启sshd服务

```bash
sudo systemctl restart sshd
```



ubuntu中的root用户需要自己更改密码之后使用

```bash
sudo passwd root 
```

![image-20251202155310826](../assets/img/Install-Ubuntu-system.assets/image-20251202155310826.png)



远程连接方面，如果你没有其他的工具，可以使用windows的cmd工具进行测试 

`ssh username@server-address`

```bash
ssh root@10.0.0.10
```

![image-20251202155454994](../assets/img/Install-Ubuntu-system.assets/image-20251202155454994.png)

 如果你前面网卡配置的是DHCP的话，编辑`/etc/netplan/50-cloud-init.yaml`文件

```bash
sudo vim /etc/netplan/50-cloud-init.yaml
```

```yaml
network:
    ethernets:
        ens33:	# 网卡设备
            addresses:	# 网卡地址
            - 10.0.0.10/24	# 地址写法需要加上子网掩码位数
            nameservers:	# 网卡dns服务器
                addresses: []
                search: []
        ens34:
            addresses:
            - 192.168.35.10/24
            nameservers:
                addresses:
                - 223.5.5.5
                search: []
            routes:	# 网卡网关
            -   to: default	# 默认路由
                via: 192.168.35.2	# 默认路由地址
    version: 2
```

使用netplan工具测试网络配置文件格式是否正确

```bash
sudo netplan try
```

没有问题之后，应用网络更改

```bash
sudo netplan apply
```



**注意**，这份默认的网卡配置文件`50-cloud-init.yaml`，并不是持久化的，重启机器之后，会恢复成你安装机器时，配置网卡处的设置信息。这是因为`cloud-init`的原因，这里不多赘述这块的知识



在`/etc/netplan/50-cloud-init.yaml`文件的上方有这样一段解释，告诉了我们解决方案，就是创建禁止配置文件

```bash
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
```

创建禁止配置文件：`/etc/cloud/cloud.cfg.d/99-disable-network-config.cfg`

```bash
sudo vim /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg
```

```bash
network: {config: disabled}
```

或

```bash
sudo tee /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg << 'EOF'
network: {config: disabled}
EOF
```



清理 cloud-init 状态，生效改变

```bash
sudo cloud-init clean
```

重启测试

```bash
reboot
```

